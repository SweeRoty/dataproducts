library(caret)
set.seed(3433)
library(AppliedPredictiveModeling)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
set.seed(62433)
rf <- train(diagnosis~.,data = training, method = "rf")
gbm <- train(diagnosis~.,data = training, method = "gbm", verbose = F)
lda <- train(diagnosis~.,data = training, method = "lda")
rfpred1<-predict(rf, newdata = training)
gbmpred1 <- predict(gbm,newdata = training)
ldapred1 <- predict(lda,newdata = training)
predTDF <- data.frame(rf=rfpred1,gbm=gbmpred1,lda=ldapred1, diagnosis=training$diagnosis)
model <- train(diagnosis~.,data=predTDF,method="rf")
rfpred<-predict(rf, newdata = testing)
gbmpred<-predict(gbm,newdata = testing)
ldapred<-predict(lda,newdata = testing)
predDF <- data.frame(rf=rfpred,gbm=gbmpred,lda=ldapred, diagnosis=testing$diagnosis)
pred <- predict(model, newdata = predDF)
mean(pred == testing$diagnosis)
mean(gbmpred == testing$diagnosis)
mean(rfpred == testing$diagnosis)
mean(ldapred == testing$diagnosis)
data(mtcars)
pairs(~ mpg + disp + hp + drat + wt + qsec, data = mtcars)
with(mtcars, cor(mpg, qsec))
?mtcars
fit1 <- lm(mpg ~ disp, data = mtcars)
fit2 <- lm(mpg ~ disp + hp, data = mtcars)
fit3 <- lm(mpg ~ disp + hp + drat, data = mtcars)
fit4 <- lm(mpg ~ disp + hp + drat + wt, data = mtcars)
anova(fit1, fit2, fit3, fit4)
pairs(~ mpg + cyl + vs + am + gear + carb, data = mtcars)
with(mtcars, cor(mpg, carb))
with(mtcars, cor(mpg, gear))
fit5 <- lm(mpg ~ disp + hp + drat + wt + cyl, data = mtcars)
fit5 <- lm(mpg ~ disp + hp + drat + wt + cyl + vs, data = mtcars)
fit5 <- lm(mpg ~ disp + hp + drat + wt + cyl, data = mtcars)
fit6 <- lm(mpg ~ disp + hp + drat + wt + cyl + vs, data = mtcars)
anova(fit1, fit2, fit3, fit4, fit5, fit6)
mtcars$cyl <- as.factor(mtcars$cyl)
fit5 <- lm(mpg ~ disp + hp + drat + wt + cyl, data = mtcars)
anova(fit1, fit2, fit3, fit4, fit5)
fit51 <- lm(mpg ~ disp + hp + drat + wt + vs, data = mtcars)
anova(fit1, fit2, fit3, fit4, fit51)
mtcars$vs <- as.factor(mtcars$vs)
fit51 <- lm(mpg ~ disp + hp + drat + wt + vs, data = mtcars)
anova(fit1, fit2, fit3, fit4, fit51)
lm(mpg~cyl,data=mtcars)
fit52 <- lm(mpg ~ disp + hp + drat + wt + am, data = mtcars)
anova(fit1, fit2, fit3, fit4, fit52)
mtcars$am <- as.factor(mtcars$am)
fit52 <- lm(mpg ~ disp + hp + drat + wt + am, data = mtcars)
anova(fit1, fit2, fit3, fit4, fit52)
fit21 <- lm(mpg ~ disp + hp + disp:hp)
fit21 <- lm(mpg ~ disp + hp + disp:hp, data = mtcars)
anova(fit1, fit2, fit21)
fit31 <- lm(mpg ~ disp + hp + drat + disp : hp)
fit31 <- lm(mpg ~ disp + hp + drat + disp : hp, data = mtcars)
anova(fit1, fit2, fit21, fit31)
fit31 <- lm(mpg ~ disp + hp + drat + disp : drat, data = mtcars)
anova(fit1, fit2, fit21, fit31)
pairs(~ mpg + disp + hp + drat + wt + qsec, data = mtcars)
fit22 <- lm(mpg ~ disp + cyl, data = mtcars)
anova(fit1, fit22)
fit32 <- lm(mpg ~ disp + hp + cyl, data = mtcars)
anova(fit1, fit22, fit32)
data(mtcars)
fit23 <- lm(mpg ~ disp + disp:qsec, data = mtcars)
anova(fit1, fit23)
cor(mtcars)
fit33 <- lm(mpg ~ disp + drat + disp:drat, data = mtcars)
anova(fit, fit33)
anova(fit1, fit33)
fit41 <- lm(mpg ~ disp + hp + drat + disp:drap)
fit41 <- lm(mpg ~ disp + hp + drat + disp:drap, data = mtcars)
fit41 <- lm(mpg ~ disp + hp + drat + disp:drat, data = mtcars)
anova(fit1, fit2, fit3, fit41)
aonva(fit1, fit2, fit3)
anova(fit1, fit2, fit3)
anova(fit1, fit2, fit3, fit4)
fit2 <- update(fit1, mpg ~ disp + hp)
fit3 <- update(fit1, mpg ~ disp + hp + drat)
anova(fit1, fit2, fit3)
fit24 <- lm(mpg ~ cyl + disp, data = mtcars)
anova(fit1, fit24)
summary(fit2)
summary(fit3)
summary(fit1)
summary(fit4)
pairs(~.,data=mtcars)
x1 <- rnorm(20)
x2 <- rnorm(20)
y <- x1 + 2*x1*x2
str(y)
test <- lm(y~x1+x1:x2)
summary(test)
plot(x2, y)
cor(x2,y)
cor(x1,y)
y <- x1 + x2 + 2*x1*x2 + rnrom(20)
y <- x1 + x2 + 2*x1*x2 + rnorm(20)
test <- lm(y~x1*x2)
summary(test)
cor(y,x1,x2)
cor(y,x1)
cor(y,x2)
plot(x1, y)
plot(x2, y)
x2 <- 3*x1 + rnorm(20)
y <- x1 + x2
y <- x1 + x2 + rnorm(20)
test <- lm(y~x1 + x2)
summary(test)
cor(x1,x2)
y <- x1 + x2 + 4*x1*x2 + rnorm(20)
test <- lm(y~x1 * x2)
summary(test)
cor(mtcars)
x2 <- rnorm(20)
y < x1 + x2 + rnorm(20)
y <- x1 + x2 + rnorm(20)
cor(x1,x2)
test<-lm(y~x1+x2)
summary(test)
test <- lm(mpg ~ wt + drat, data = mtcars)
summary(test)
with(mtcars, plot(qsec*disp, mpg))
with(mtcars, plot(disp, mpg))
test <- lm(mpg ~ disp*qsec, data = mtcars)
summary(test)
x2 <- 0.7*x1 + rnorm
x2 <- 0.7*x1 + rnorm(20)
cor(x1,x2)
y <- x1 + x1*x2 + rnorm(20)
cor(y,x2)
cor(y,x1)
test <- lm(y~x1*x2)
summary(test)
plot(x1, y)
plot(x1*x2, y)
plot(x1, y)
plot(x1^2, y)
test <- lm(y~x1*x1)
summary(test)
x3 <- x1*x1
all(x3 == x1^2)
test<-lm(y~x3)
summary(test)
test<-lm(y~x3-1)
summary(test)
cor(y,x3)
cor(y,x1)
x2 <- rnorm(20)
y <- x1 + x2
plot(x2, y)
plot(x1, y)
plot(x2, x1)
cor(x1,x2)
pairs(~ mpg + disp + hp + drat + wt + qsec, data = mtcars)
cor(mtcars)
disp2 <- disp^2
disp2 <- mtcars$disp^2
test<-lm(mtcars$mpg~disp2)
summary(test)
drat2 <- mtcars$drat^2
test<-lm(mtcars$mpg~drat2)
summary(test)
qsec2 <- mtcars$qsec^2
test<-lm(mtcars$mpg~qsec2)
summary(test)
test<-lm(mtcars$disp~qsec2)
summary(test)
test<-lm(mpg ~ disp*qsec,data=mtcars)
summary(test)
test<-lm(mpg ~ disp*wt,data=mtcars)
summary(test)
?mtcars
pairs(~ mpg + disp + hp + drat + wt + qsec + gear + carb, data = mtcars)
test<-lm(mpg~wt*qsec)
test<-lm(mpg~wt*qsec,data=mtcars)
summary(test)
test<-lm(mpg~qsec,data=mtcars)
summary(test)
cor(mtcars)
test<-lm(mpg~disp*qsec,data=mtcars)
summary(test)
test<-lm(mpg~hp*qsec,data=mtcars)
summary(test)
t <- mtcars$hp*mtcars$qsec
plot(t, mtcars$mpg)
test<-lm(mpg~hp + hp:qsec,data=mtcars)
summary(test)
test<-lm(mpg~hp + drat,data=mtcars)
summary(test)
test<-lm(mpg~hp + disp,data=mtcars)
summary(test)
test<-lm(mpg~hp + drat + hp:qsec,data=mtcars)
summary(test)
test<-lm(mpg~drat * qsec,data=mtcars)
summary(test)
with(mtcars, plot(drat, hp))
test<-lm(mpg~hp * drat,data=mtcars)
summary(test)
test<-lm(mpg~hp + hp:disp + drat,data=mtcars)
summary(test)
test<-lm(mpg~hp + hp:wt + drat,data=mtcars)
summary(test)
test<-lm(mpg~hp +qsec + drat,data=mtcars)
summary(test)
test<-lm(mpg~hp * qsec + drat,data=mtcars)
summary(test)
test<-lm(mpg~hp * disp,data=mtcars)
summary(test)
with(mtcars, plot(drat, qsec))
test<-lm(mpg~ qsec + qsec:hp,data=mtcars)
summary(test)
fit2 <- lm(mpg ~ hp*disp, data = mtcars)
summary(fit2)
fit22 <- lm(mpg ~ hp + hp:disp, data = mtcars)
anova(fit22,fit2)
pairs(~ mpg + disp + hp + drat + wt + qsec, data = mtcars)
cor(mtcars)
fit1 <- lm(mpg ~ wt, data = mtcars)
fit2 <- lm(mpg ~ wt*disp, data = mtcars)
anova(fit1, fit2)
summary(fit2)
fit2 <- lm(mpg ~ wt*disp + wt*hp, data = mtcars)
summary(fit2)
fit3 <- lm(mpg ~ wt + drat)
fit3 <- lm(mpg ~ wt + drat, data = mtcars)
anova(fit1, fit3)
summary(fit3)
fit4 <- lm(mpg~hp+drat,data=mtcars)
summary(fit4)
fit4 <- lm(mpg~hp+qsec,data=mtcars)
summary(fit4)
fit4 <- lm(mpg~hp*qsec,data=mtcars)
summary(fit4)
qsec2 <- mtcars$qsec^2
with(mtcars, plot(wt, qsec2))
fit <- lm(mtcars$wt~qsec2)
summary(fit)
fit4 <- lm(mpg~wt+qsec,data=mtcars)
summary(fit4)
fit4 <- lm(mpg~wt*qsec,data=mtcars)
summary(fit4)
fit5 <- lm(mpg ~ wt*disp + qsec)
fit5 <- lm(mpg ~ wt*disp + qsec,data=mtcars)
summary(fit5)
fit2
fit2 <- lm(mpg ~ wt*disp, data = mtcars)
anova(fit2,fit5)
pairs(~ mpg + cyl + vs + am + gear + carb, data = mtcars)
cor(mtcars)
fit6 <- lm(mpg ~ wt + vs, data = mtcars)
fit7 <- lm(mpg ~ wt + am, data = mtcars)
fit8 <- lm(mpg ~ wt + gear, data = mtcars)
fit9 <- lm(mpg ~ wt + carb, data = mtcars)
summary(fit6)
summary(fit7)
summary(fit8)
summary(fit9)
fit8 <- lm(mpg ~ wt * gear, data = mtcars)
summary(fit8)
mtcars$gear <- as.factor(mtcars$gear)
fit8 <- lm(mpg ~ wt * gear, data = mtcars)
summary(fit8)
fit8 <- lm(mpg ~ wt + gear, data = mtcars)
summary(fit8)
mtcars$carb <- as.factor(mtcars$carb)
fit9 <- lm(mpg ~ wt + carb, data = mtcars)
summary(fit9)
fit9 <- lm(mpg ~ wt * carb, data = mtcars)
summary(fit9)
mtcars$am <- as.factor(mtcars$am)
fit7 <- lm(mpg ~ wt + am, data = mtcars)
summary(fit7)
fit7 <- lm(mpg ~ wt * am, data = mtcars)
summary(fit7)
fit9 <- lm(mpg ~ wt + carb, data = mtcars)
summary(fit9)
data(mtcars)
?mtcars
summary(mtcars$vs)
mtcars$vs <- as.factor(mtcars$vs)
mtcars$am <- as.factor(mtcars$am)
fit6 <- lm(mpg ~ wt + vs, data = mtcars)
summary(fit6)
fit7 <- lm(mpg ~ wt + am, data = mtcars)
summary(fit7)
fit7 <- lm(mpg ~ wt * am, data = mtcars)
summary(fit7)
fit6 <- lm(mpg ~ wt * vs, data = mtcars)
summary(fit6)
fit8 <- lm(mpg ~ wt + gear, data = mtcars
)
summary(fit8)
fit8 <- lm(mpg ~ wt * gear, data = mtcars
)
summary(fit8)
fit9 <- lm(mpg ~ wt + carb, data = mtcars)
summary(fit9)
fit9 <- lm(mpg ~ wt * carb, data = mtcars)
summary(fit9)
fit2 <- lm(mpg ~ wt*disp + vs, data = mtcars)
summary(fit2)
fit2 <- lm(mpg ~ wt*disp + am, data = mtcars)
summary(fit2)
fit2 <- lm(mpg ~ wt*disp + wt*am, data = mtcars)
summary(fit2)
fit10 <- lm(mpg ~ am, data = mtcars)
summary(fit10)
fit5 <- lm(mpg ~ wt*disp + qsec + carb)
fit5 <- lm(mpg ~ wt*disp + qsec + carb, data = mtcars)
summary(fit5)
with(mtcars,cor(qsec,carb))
fit5 <- lm(mpg ~ wt*disp + qsec * carb, data = mtcars)
summary(fit5)
str(mtcars)
summary(mtcars)
boxplot(mtcars)
str(mtcars)
?mtcars
mtcars$vs
mtcars$gear
mtcars$carb
pairs(~ mpg + cyl + vs + am + gear + carb, data = mtcars)
c <- c(1,2,3)
c <- as.factor(c)
c
c[1] - c[2]
c <- integer()
c <- c(c,2.5)
class(c)
c <- integer()
class(c)
?pairs
pairs(~ mpg + disp + hp + drat + wt + qsec, data = mtcars)
pairs(~ mpg + cyl + vs + am + gear + carb, data = mtcars)
pairs(~ mpg + disp + hp + drat + wt + qsec, data = mtcars)
str(mtcars)
m <- lm(mpg~wt*am,data=mtcars)
summary(m)
m <- lm(mpg~wt*am+qsec,data=mtcars)
summary(m)
m <- lm(mpg~wt*am+qsec+disp,data=mtcars)
summary(m)
data(mtcars)
with(mtcars, plot(wt, mpg, col=am))
mtcars$am <- factor(mtcars$am)
with(mtcars, plot(wt, mpg, col=am))
with(mtcars, plot(wt, mpg, col=1))
with(mtcars, plot(wt, mpg, col=2))
with(mtcars, plot(wt, mpg, col=am))
?mtcars
fit1 <- lm(mpg ~ am, data = mtcars)
summary(fit1)
?title
z1 <- rexp(100)
z2 <- rexp(100)
z3 <- rexp(100)
z4 <- rexp(100)
par(mfrow=c(2,2),oma = c(0, 0, 3, 0))
curve(dexp,from=0,to=5)
hist(z1,main="first")
hist(z2,main="second")
hist(z3,main="third")
mtext("Densities", outer = TRUE, cex = 1.5)
?par
?mtext
data(mtcars)
mean(mtcars[mtcars$am == 1,]$mpg)
mean(mtcars[mtcars$am == 0,]$mpg)
?lm
fit1 <- lm(mpg ~ am, data = mtcars)
fit1$call
s <- summary(fit1)
s
str(s)
s$call
fit1 <- lm(mpg ~ am*drat + qsec, data = mtcars)
mtcars$am <- factor(mtcars$am)
with(mtcars, plot(drat, mpg, col = am, pch = 19))
data(mtcars)
mtcars$am <- as.factor(mtcars$am)
fit <- lm(mpg~am*wt, data=mtcars)
summary(fit)
with(mtcars, plot(qsec, mpg, col=am,pch=10))
fit2 <- lm(mpg~am*wt+qsec, data=mtcars)
summary(fit2)
cor(mtcars)
data(mtcars)
cor(mtcars)
mtcars
man <- mean(mtcars[mtcars$am == 1, ]$mpg)
aut <- mean(mtcars[mtcars$am == 0, ]$mpg)
man - aut
?mtcars
data(airquality)
str(airquality)
fit <- lm(Ozone ~ Wind, data = airquality)
with(airquality, plot(Wind, Ozone, pch = 19))
abline(fit)
with(airquality, plot(Wind, Temp, pch = 19))
with(airquality, plot(Temp, Ozone, pch = 19))
with(airquality, plot(Solar.R, Ozone, pch = 19))
with(airquality, plot(Solar.R, Ozone, pch = 20))
setwd("/Users/hanmarvin/Documents/CS/Data Science Track/Data Products/myCourseraApp")
runApp()
library(shiny)
runApp()
?radioButtons
runApp()
runApp()
runApp()
runApp()
?airquality
runApp()
fit$coefficient
paste("Ozone ~ ", "Temp")
paste("Ozone ~", "Temp")
as.formula(paste("Ozone ~", "Temp"))
?lm
fit$terms
plot(fit$x,fit$y)
fit$x
fit$y
fit[[x]]
fit[['x']]
fit$call
class(fit$call)
library(ggplot2)
?qplot
qplot(Wind, Ozone, data = airquality)
qplot(Wind, Ozone, data = airquality, geom = "smooth", method = "lm")
qplot(Wind, Ozone, data = airquality, geom = c("points", smooth"), method = "lm")
qplot(Wind, Ozone, data = airquality, geom = c("point", smooth"), method = "lm")
qplot(Wind, Ozone, data = airquality, geom = c("point", "smooth"), method = "lm")
na <- sapply(1:nrow(airquality), function(i) {any(is.na(airquality[i, ])) } )
data <- airquality[!na, ]
variable <- "Wind"
data[[variable]]
qplot(Wind, data[[variable]], data = data, geom = c("point", "smooth"), method = "lm")
qplot(data[["Ozone"]], data[[variable]], data = data, geom = c("point", "smooth"), method = "lm")
qplot(data[["Ozone"]], data[[variable]], geom = c("point", "smooth"), method = "lm")
runApp()
runApp()
runApp()
m<-qplot(data[["Ozone"]], data[[variable]], geom = c("point", "smooth"), method = "lm")
?ggplot
?qplot
x <- "Wind"
y <- "Ozone"
g <- ggplot(data, ads(x,y))
?ggplot
g <- ggplot(data, aes(x,y))
g <- ggplot(data, aes(x,y)) + geom_point() + geom_smooth(method = “lm”)
g <- ggplot(data, aes(x,y)) + geom_point() + geom_smooth(method = "lm")
print(g)
g <- ggplot(data, aes(x,y)) + geom_point()
print(g)
g <- ggplot(data, aes(Wind,Ozone)) + geom_point() + geom_smooth(method = "lm")
print(g)
g <- ggplot(aes(data$Wind,data$Ozone)) + geom_point() + geom_smooth(method = "lm")
data2 <- data.frame(X = data[["Wind"]], Y = data[["Ozone"]])
head(data2)
g <- ggplot(data2, aes(X,Y)) + geom_point() + geom_smooth(method = "lm")
print(g)
?ggplot
runApp()
fit$coef
runApp()
runApp()
runApp()
runApp()
runApp()
?renderDataTable
runApp()
runApp()
runApp()
g <- ggplot(data2, aes(X,Y)) + geom_point() + geom_smooth(method = "lm")  + labs(x = 1, y = 2)
print(g)
runApp()
g <- ggplot(data2, aes(X,Y)) + geom_point() + geom_smooth(method = "lm")  + labs(x = 1, y = "Ozone")
print(g)
g <- ggplot(data2, aes(X,Y)) + geom_point() + geom_smooth(method = "lm")  + labs(x = variable, y = "Ozone")
print(g)
runApp()
runApp()
runApp()
runApp()
runApp()
?airquality
runApp()
library(shinyapps)
shinyapps::setAccountInfo(name='sweeroty', token='286D6C2D87E7942B9D34BA284BB4B384', secret='kJKpyWNj2XnW5ZxeOIJSseiGjy2NeWm6mNyWdyH2')
deployApp()
library(slidify)
slidify("index.Rmd")
setwd("/Users/hanmarvin/Documents/CS/Data Science Track/Data Products/mySlidify/mySlidify")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
slidify("index.Rmd")
?publish
?publish
